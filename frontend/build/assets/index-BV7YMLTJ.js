import{u as E,b as I,c as $,r as u,f as P,g as D,h as F,j as i,L as l}from"./index-5xEUM_gm.js";import{H as O}from"./index.esm-5bBGV7pT.js";import{L as z,E as M}from"./index-1QyoW5zR.js";const Z=()=>{const{t:s}=E(),p=I(),{slug:j}=$(),[o,_]=u.useState(0),[x,N]=u.useState(!1),{isAuthenticated:g,user:c}=P(t=>({isAuthenticated:t.auth.isAuthenticated,user:t.auth.user})),{data:m,isLoading:v,error:f,refetch:b}=D(j||""),[S,{isLoading:d}]=F();if(v)return i.jsx(z,{fullPage:!0,text:s("listing.loading")});if(f||!m)return i.jsxs("div",{className:"listing-detail-page",children:[i.jsx(M,{message:s("listing.notFound"),details:s("listing.notFoundDetails"),onRetry:()=>b()}),i.jsx("div",{className:"listing-detail-page__back",children:i.jsx(l,{to:"/listings",children:s("common.backToListings")})})]});const e=m.data,k=g&&(c==null?void 0:c.id)===e.userId,L=g&&(c==null?void 0:c.role)==="admin",w=k||L,y=t=>t.toLocaleString("az-AZ"),h=t=>new Date(t).toLocaleDateString("az-AZ",{year:"numeric",month:"long",day:"numeric"}),r=async t=>{if(e.id)try{await S({id:e.id,status:t}).unwrap(),t==="deleted"&&p("/listings")}catch(a){console.error("Failed to change status:",a)}},n=e.images||[];return e.featuredImage&&!n.includes(e.featuredImage)&&n.unshift(e.featuredImage),n.length===0&&n.push("/images/placeholder.jpg"),i.jsxs("div",{className:"listing-detail-page",children:[i.jsxs(O,{children:[i.jsxs("title",{children:[e.title," | Mart.az"]}),i.jsx("meta",{name:"description",content:e.description.substring(0,160)})]}),i.jsxs("div",{className:"listing-detail-page__breadcrumbs",children:[i.jsx(l,{to:"/",children:s("common.home")})," >",i.jsx(l,{to:"/listings",children:s("common.listings")})," >",e.category&&i.jsxs(i.Fragment,{children:[i.jsx(l,{to:`/categories/${e.category.slug}`,children:e.category.name})," >"]}),i.jsx("span",{children:e.title})]}),i.jsxs("div",{className:"listing-detail-page__content",children:[i.jsxs("div",{className:"listing-detail-page__gallery",children:[i.jsxs("div",{className:"listing-detail-page__main-image",children:[i.jsx("img",{src:n[o],alt:e.title,onError:t=>{const a=t.target;a.src="/images/placeholder.jpg"}}),e.isPromoted&&i.jsx("span",{className:"listing-detail-page__badge listing-detail-page__badge--promoted",children:s("listing.promoted")}),e.isFeatured&&i.jsx("span",{className:"listing-detail-page__badge listing-detail-page__badge--featured",children:s("listing.featured")})]}),n.length>1&&i.jsx("div",{className:"listing-detail-page__thumbnails",children:n.map((t,a)=>i.jsx("div",{className:`listing-detail-page__thumbnail ${a===o?"active":""}`,onClick:()=>_(a),children:i.jsx("img",{src:t,alt:`${e.title} - ${a+1}`,onError:A=>{const C=A.target;C.src="/images/placeholder.jpg"}})},a))})]}),i.jsxs("div",{className:"listing-detail-page__info",children:[i.jsx("h1",{className:"listing-detail-page__title",children:e.title}),i.jsxs("div",{className:"listing-detail-page__meta",children:[i.jsxs("div",{className:"listing-detail-page__price",children:[y(e.price)," ",e.currency]}),i.jsxs("div",{className:"listing-detail-page__location",children:[i.jsx("i",{className:"icon-location"})," ",e.location]}),i.jsxs("div",{className:"listing-detail-page__date",children:[s("listing.postedOn"),": ",h(e.createdAt)]}),i.jsxs("div",{className:"listing-detail-page__views",children:[i.jsx("i",{className:"icon-eye"})," ",e.views," ",s("listing.views")]})]}),e.condition&&i.jsxs("div",{className:"listing-detail-page__condition",children:[i.jsxs("strong",{children:[s("listing.condition"),":"]})," ",s(`condition.${e.condition}`)]}),i.jsxs("div",{className:"listing-detail-page__description",children:[i.jsx("h2",{children:s("listing.description")}),i.jsx("div",{className:"listing-detail-page__description-content",children:e.description.split(`
`).map((t,a)=>i.jsx("p",{children:t},a))})]}),Object.keys(e.attributes||{}).length>0&&i.jsxs("div",{className:"listing-detail-page__attributes",children:[i.jsx("h2",{children:s("listing.attributes")}),i.jsx("ul",{children:Object.entries(e.attributes||{}).map(([t,a])=>i.jsxs("li",{children:[i.jsxs("strong",{children:[t,":"]})," ",a]},t))})]}),i.jsxs("div",{className:"listing-detail-page__contact",children:[i.jsx("h2",{children:s("listing.contactSeller")}),x?i.jsxs("div",{className:"listing-detail-page__contact-info",children:[e.contactPhone&&i.jsxs("div",{className:"listing-detail-page__contact-item",children:[i.jsx("i",{className:"icon-phone"}),i.jsx("a",{href:`tel:${e.contactPhone}`,children:e.contactPhone})]}),e.contactEmail&&i.jsxs("div",{className:"listing-detail-page__contact-item",children:[i.jsx("i",{className:"icon-mail"}),i.jsx("a",{href:`mailto:${e.contactEmail}`,children:e.contactEmail})]}),!e.contactPhone&&!e.contactEmail&&i.jsx("p",{children:s("listing.noContactInfo")})]}):i.jsx("button",{className:"listing-detail-page__contact-button",onClick:()=>N(!0),children:s("listing.showContactInfo")})]}),e.user&&i.jsxs("div",{className:"listing-detail-page__seller",children:[i.jsx("h2",{children:s("listing.aboutSeller")}),i.jsxs("div",{className:"listing-detail-page__seller-info",children:[i.jsx("img",{src:e.user.profileImage||"/images/user-placeholder.jpg",alt:`${e.user.firstName} ${e.user.lastName}`,className:"listing-detail-page__seller-image",onError:t=>{const a=t.target;a.src="/images/user-placeholder.jpg"}}),i.jsxs("div",{children:[i.jsxs("h3",{children:[e.user.firstName," ",e.user.lastName]}),i.jsxs("p",{children:[s("listing.memberSince")," ",h(e.user.createdAt)]}),i.jsx(l,{to:`/users/${e.user.id}`,className:"listing-detail-page__seller-link",children:s("listing.viewProfile")})]})]})]}),w&&i.jsxs("div",{className:"listing-detail-page__actions",children:[i.jsx("h2",{children:s("listing.actions")}),i.jsxs("div",{className:"listing-detail-page__buttons",children:[i.jsx(l,{to:`/listings/${e.id}/edit`,className:"listing-detail-page__edit-button",children:s("listing.edit")}),e.status==="active"&&i.jsx("button",{className:"listing-detail-page__status-button",onClick:()=>r("sold"),disabled:d,children:s("listing.markAsSold")}),e.status==="sold"&&i.jsx("button",{className:"listing-detail-page__status-button",onClick:()=>r("active"),disabled:d,children:s("listing.markAsActive")}),i.jsx("button",{className:"listing-detail-page__delete-button",onClick:()=>{window.confirm(s("listing.confirmDelete"))&&r("deleted")},disabled:d,children:s("listing.delete")})]})]})]})]}),i.jsx("div",{className:"listing-detail-page__back",children:i.jsx(l,{to:"/listings",children:s("common.backToListings")})})]})};export{Z as default};
//# sourceMappingURL=index-BV7YMLTJ.js.map
