import{u as B,a as W,c as S,r as p,f as E,s as I,g as $,h as P,j as e,L as a,H as D}from"./index-Ii0svv0K.js";import{L as H,E as z}from"./index-DGkR6v-M.js";const O=()=>{const{t:s}=B(),j=W(),{slug:m}=S(),[d,u]=p.useState(0),[w,v]=p.useState(!1),{isAuthenticated:g,user:r}=E(I),{data:h,isLoading:_,error:k,refetch:f}=$(m||""),[L,{isLoading:o}]=P();if(_)return e.jsx(H,{fullPage:!0,text:s("listing.loading")});if(k||!h)return e.jsx("div",{className:"listing-detail-page",children:e.jsxs("div",{className:"listing-detail-page__container",children:[e.jsx(z,{message:s("listing.notFound"),details:s("listing.notFoundDetails"),onRetry:()=>f()}),e.jsx("div",{className:"listing-detail-page__back",children:e.jsxs(a,{to:"/listings",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("path",{d:"M19 12H5M12 19l-7-7 7-7"})}),s("common.backToListings")]})})]})});const i=h.data,N=g&&(r==null?void 0:r.id)===i.userId,b=g&&(r==null?void 0:r.role)==="admin",y=N||b,C=t=>t==null?"0":t.toLocaleString("az-AZ"),x=t=>new Date(t).toLocaleDateString("az-AZ",{year:"numeric",month:"long",day:"numeric"}),c=async t=>{if(i.id)try{await L({id:i.id,status:t}).unwrap(),t==="deleted"&&j("/listings")}catch(n){console.error("Failed to change status:",n)}},l=i.images||[];return i.featuredImage&&!l.includes(i.featuredImage)&&l.unshift(i.featuredImage),l.length===0&&l.push("/images/placeholder.jpg"),e.jsxs("div",{className:"listing-detail-page",children:[e.jsxs(D,{children:[e.jsxs("title",{children:[i.title," | Mart.az"]}),e.jsx("meta",{name:"description",content:i.description?i.description.substring(0,160):""})]}),e.jsxs("div",{className:"listing-detail-page__container",children:[e.jsxs("div",{className:"listing-detail-page__breadcrumbs",children:[e.jsx(a,{to:"/",children:s("common.home")}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("polyline",{points:"9 18 15 12 9 6"})}),e.jsx(a,{to:"/listings",children:s("common.listings")}),i.category&&e.jsxs(e.Fragment,{children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("polyline",{points:"9 18 15 12 9 6"})}),e.jsx(a,{to:`/categories/${i.category.slug}`,children:i.category.name})]}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("polyline",{points:"9 18 15 12 9 6"})}),e.jsx("span",{children:i.title})]}),e.jsxs("div",{className:"listing-detail-page__content",children:[e.jsxs("div",{className:"listing-detail-page__gallery",children:[e.jsxs("div",{className:"listing-detail-page__main-image",children:[e.jsx("img",{src:l[d],alt:i.title,onError:t=>{const n=t.target;n.src="/images/placeholder.jpg"}}),i.isPromoted&&e.jsx("span",{className:"listing-detail-page__badge listing-detail-page__badge--promoted",children:s("listing.promoted")}),i.isFeatured&&e.jsx("span",{className:"listing-detail-page__badge listing-detail-page__badge--featured",children:s("listing.featured")})]}),l.length>1&&e.jsx("div",{className:"listing-detail-page__thumbnails",children:l.map((t,n)=>e.jsx("div",{className:`listing-detail-page__thumbnail ${n===d?"active":""}`,onClick:()=>u(n),children:e.jsx("img",{src:t,alt:`${i.title} - ${n+1}`,onError:M=>{const A=M.target;A.src="/images/placeholder.jpg"}})},n))})]}),e.jsxs("div",{className:"listing-detail-page__info",children:[e.jsx("h1",{className:"listing-detail-page__title",children:i.title}),e.jsxs("div",{className:"listing-detail-page__meta",children:[e.jsxs("div",{className:"listing-detail-page__price",children:[C(i.price)," ",i.currency]}),e.jsxs("div",{className:"listing-detail-page__location",children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z"}),e.jsx("circle",{cx:"12",cy:"10",r:"3"})]}),i.location]}),e.jsxs("div",{className:"listing-detail-page__date",children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2"}),e.jsx("line",{x1:"16",x2:"16",y1:"2",y2:"6"}),e.jsx("line",{x1:"8",x2:"8",y1:"2",y2:"6"}),e.jsx("line",{x1:"3",x2:"21",y1:"10",y2:"10"})]}),s("listing.postedOn"),": ",x(i.createdAt)]}),e.jsxs("div",{className:"listing-detail-page__views",children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z"}),e.jsx("circle",{cx:"12",cy:"12",r:"3"})]}),i.views||0," ",s("listing.views")]})]}),i.condition&&e.jsxs("div",{className:"listing-detail-page__condition",children:[e.jsxs("strong",{children:[s("listing.condition"),":"]})," ",s(`condition.${i.condition}`)]}),e.jsxs("div",{className:"listing-detail-page__description",children:[e.jsx("h2",{children:s("listing.description")}),e.jsx("div",{className:"listing-detail-page__description-content",children:i.description?i.description.split(`
`).map((t,n)=>e.jsx("p",{children:t},n)):e.jsx("p",{children:s("listing.noDescription")})})]}),Object.keys(i.attributes||{}).length>0&&e.jsxs("div",{className:"listing-detail-page__attributes",children:[e.jsx("h2",{children:s("listing.attributes")}),e.jsx("ul",{children:Object.entries(i.attributes||{}).map(([t,n])=>e.jsxs("li",{children:[e.jsxs("strong",{children:[t,":"]})," ",n]},t))})]}),e.jsxs("div",{className:"listing-detail-page__contact",children:[e.jsx("h2",{children:s("listing.contactSeller")}),w?e.jsxs("div",{className:"listing-detail-page__contact-info",children:[i.contactPhone&&e.jsxs("div",{className:"listing-detail-page__contact-item",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"})}),e.jsx("a",{href:`tel:${i.contactPhone}`,children:i.contactPhone})]}),i.contactEmail&&e.jsxs("div",{className:"listing-detail-page__contact-item",children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("rect",{width:"20",height:"16",x:"2",y:"4",rx:"2"}),e.jsx("path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7"})]}),e.jsx("a",{href:`mailto:${i.contactEmail}`,children:i.contactEmail})]}),!i.contactPhone&&!i.contactEmail&&e.jsx("p",{children:s("listing.noContactInfo")})]}):e.jsxs("button",{className:"listing-detail-page__contact-button",onClick:()=>v(!0),children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"})}),s("listing.showContactInfo")]})]}),i.user&&e.jsxs("div",{className:"listing-detail-page__seller",children:[e.jsx("h2",{children:s("listing.aboutSeller")}),e.jsxs("div",{className:"listing-detail-page__seller-info",children:[e.jsx("img",{src:i.user.profileImage||"/images/user-placeholder.jpg",alt:`${i.user.firstName||""} ${i.user.lastName||""}`,className:"listing-detail-page__seller-image",onError:t=>{const n=t.target;n.src="/images/user-placeholder.jpg"}}),e.jsxs("div",{children:[e.jsxs("h3",{children:[i.user.firstName||""," ",i.user.lastName||""]}),i.user.createdAt&&e.jsxs("p",{children:[s("listing.memberSince")," ",x(i.user.createdAt)]}),e.jsxs(a,{to:`/users/${i.user.id}`,className:"listing-detail-page__seller-link",children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"}),e.jsx("circle",{cx:"12",cy:"7",r:"4"})]}),s("listing.viewProfile")]})]})]})]}),y&&e.jsxs("div",{className:"listing-detail-page__actions",children:[e.jsx("h2",{children:s("listing.actions")}),e.jsxs("div",{className:"listing-detail-page__buttons",children:[e.jsxs(a,{to:`/listings/${i.id}/edit`,className:"listing-detail-page__edit-button",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("path",{d:"M17 3a2.85 2.85 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z"})}),s("listing.edit")]}),i.status==="active"&&e.jsxs("button",{className:"listing-detail-page__status-button",onClick:()=>c("sold"),disabled:o,children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("polyline",{points:"20 6 9 17 4 12"})}),s("listing.markAsSold")]}),i.status==="sold"&&e.jsxs("button",{className:"listing-detail-page__status-button",onClick:()=>c("active"),disabled:o,children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("polyline",{points:"23 4 23 10 17 10"}),e.jsx("path",{d:"M20.49 15a9 9 0 1 1-2.12-9.36L23 10"})]}),s("listing.markAsActive")]}),e.jsxs("button",{className:"listing-detail-page__delete-button",onClick:()=>{window.confirm(s("listing.confirmDelete"))&&c("deleted")},disabled:o,children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M3 6h18"}),e.jsx("path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"}),e.jsx("path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"})]}),s("listing.delete")]})]})]})]})]}),e.jsx("div",{className:"listing-detail-page__back",children:e.jsxs(a,{to:"/listings",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("path",{d:"M19 12H5M12 19l-7-7 7-7"})}),s("common.backToListings")]})})]})]})};export{O as default};
